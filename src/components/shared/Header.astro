---
import { Image } from "astro:assets";
import NavbarMobileMenu from "./headerMenus/NavbarMobileMenu.astro";
import NavbarDesktopMenu from "./headerMenus/NavbarDesktopMenu.astro";

const currentPath = Astro.url.pathname;
---

<header class="flex items-center justify-between">
  <nav class="flex justify-between items-center mx-auto w-full my-2">
    <a href="/" class="flex-shrink-0">
      <Image src="/favicon.svg" width={20} height={20} alt=`mrjark logo` />
    </a>
    <NavbarMobileMenu />
    <NavbarDesktopMenu />
  </nav>
</header>

<script>
  document.addEventListener("astro:page-load", () => {
    const primaryNav = document.querySelector(
      ".navigation-mobile-menu"
    ) as HTMLUListElement;
    const navToggle = document.querySelector(
      ".mobile-nav-toggle"
    ) as HTMLButtonElement;

    const toggleMenu = () => {
      const visibility = primaryNav.getAttribute("data-visible");
      if (visibility === "false") {
        primaryNav.setAttribute("data-visible", "true");
        navToggle.setAttribute("aria-expanded", "true");
      } else {
        primaryNav.setAttribute("data-visible", "false");
        navToggle.setAttribute("aria-expanded", "false");
      }
    };

    const closeMenu = () => {
      primaryNav.setAttribute("data-visible", "false");
      navToggle.setAttribute("aria-expanded", "false");
    };

    navToggle.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleMenu();
    });

    document.addEventListener("click", (e) => {
      const isClickInsideMenu = primaryNav.contains(e.target as Node);
      const isClickInsideButton = navToggle.contains(e.target as Node);
      if (!isClickInsideMenu && !isClickInsideButton) {
        closeMenu();
      }
    });
  });
</script>

<!-- ---
import { HEADER_LINKS } from "@/global/headerLinks";
import NavLinks from "@shared/NavLinks.astro";
import { Image } from "astro:assets";

const currentPath = Astro.url.pathname;
---

<header>
  <nav class="my-2 w-full">
    <section class="flex justify-between items-center mx-auto">
      <a href="/">
        <Image src="/favicon.svg" width={20} height={20} alt=`mrjark logo` />
      </a>
      <div class="flex gap-4 justify-center items-center text-sm">
        {
          HEADER_LINKS.map(({ customClasses, href, text }) => (
            <NavLinks
              href={href}
              text={text}
              currentPath={currentPath}
              customClasses={customClasses}
            />
          ))
        }
      </div>
    </section>
  </nav>
</header> -->
